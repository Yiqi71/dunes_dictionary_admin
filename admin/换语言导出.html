<!DOCTYPE html>

<html lang="zh-CN">

<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>沙丘词典中台 Dunes Dictionary Dashboard</title>


  <!-- Tailwind CSS -->

  <script src="https://cdn.tailwindcss.com"></script>


  <!-- Chart.js for Charts -->

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


  <!-- Lucide Icons -->

  <script src="https://unpkg.com/lucide@latest"></script>


  <!-- Custom Font Configuration to match the design -->

  <style>
    body {

      font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;

      background-color: #fdfcf8;
      /* Paper white background */

    }

    /* Custom scrollbar for table/modal if needed */

    ::-webkit-scrollbar {

      width: 8px;

      height: 8px;

    }

    ::-webkit-scrollbar-track {

      background: #f1f1f1;

    }

    ::-webkit-scrollbar-thumb {

      background: #d6d3d1;

      border-radius: 4px;

    }

    ::-webkit-scrollbar-thumb:hover {

      background: #a8a29e;

    }
  </style>

</head>

<body class="text-stone-900 min-h-screen p-6 md:p-10">


  <!-- Navbar / Top Bar -->

  <div class="flex flex-col md:flex-row md:items-center justify-between mb-8 pb-6 border-b border-stone-200">

    <div>

      <h1 class="text-3xl font-bold tracking-tight text-stone-900">

        沙丘词典中台 <span class="text-stone-400 font-light mx-2">|</span> Dunes Dictionary Dashboard

      </h1>

      <p class="text-stone-500 text-sm mt-1 tracking-wide uppercase">数据看板 & 运营中心 Analytics & Operations</p>

    </div>


    <div class="relative mt-4 md:mt-0">

      <button id="exportBtn"
        class="flex items-center gap-2 bg-stone-900 text-white px-4 py-2 rounded-md hover:bg-stone-800 transition-colors shadow-sm text-sm">

        <i data-lucide="download" class="w-4 h-4"></i>

        导出数据 Export Data

        <i data-lucide="chevron-down" class="w-3 h-3"></i>

      </button>


      <!-- Export Dropdown -->

      <div id="exportMenu"
        class="hidden absolute right-0 mt-2 w-48 bg-white border border-stone-200 rounded-md shadow-lg z-20 py-1">

        <button class="w-full text-left px-4 py-2 text-sm text-stone-700 hover:bg-stone-50">

          上周数据 (.xlsx) Last Week

        </button>

        <button class="w-full text-left px-4 py-2 text-sm text-stone-700 hover:bg-stone-50">

          所有数据 (.xlsx) All Data

        </button>

      </div>

    </div>

  </div>


  <div class="max-w-7xl mx-auto space-y-8">


    <!-- Row 1: Overview (Real-time) -->

    <div class="flex items-center gap-2 mb-3 mt-6">

      <div class="w-1 h-4 bg-amber-600 rounded-full"></div>

      <h2 class="text-lg font-bold text-stone-800">总览 Overview</h2>

    </div>


    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

      <!-- Total UV -->

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">访问用户 Total UV</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-green-100 text-green-800 border-green-200">

            <i data-lucide="activity" class="w-2.5 h-2.5 mr-1 animate-pulse"></i> 实时 Real-time

          </span>

        </div>

        <div class="flex items-baseline gap-2">

          <span class="text-4xl font-bold text-stone-900">1,248</span>

          <span class="text-xs font-medium text-green-600 bg-green-50 px-1.5 py-0.5 rounded">+12% vs avg</span>

        </div>

        <p class="text-stone-400 text-xs mt-2">当前在线用户 Active users currently on site: 42</p>

      </div>


      <!-- Total Active Time -->

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">有效访问时长 Total Active Time</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-green-100 text-green-800 border-green-200">

            <i data-lucide="activity" class="w-2.5 h-2.5 mr-1 animate-pulse"></i> 实时 Real-time

          </span>

        </div>

        <div class="flex items-baseline gap-2">

          <span class="text-4xl font-bold text-stone-900">86.4</span>

          <span class="text-stone-500 text-lg">hrs</span>

        </div>

        <p class="text-stone-400 text-xs mt-2">平均会话时长 Avg. session duration: 4m 12s</p>

      </div>

    </div>


    <!-- Row 2: Language Stats -->

    <div class="flex items-center gap-2 mb-3 mt-6">

      <div class="w-1 h-4 bg-amber-600 rounded-full"></div>

      <h2 class="text-lg font-bold text-stone-800">语言分布 Language</h2>

    </div>


    <div class="grid grid-cols-1 gap-6">

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">中英文切换 EN/CN Switch</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-stone-100 text-stone-600 border-stone-200">

            <i data-lucide="clock" class="w-2.5 h-2.5 mr-1"></i> 昨日 Yesterday

          </span>

        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 divide-y md:divide-y-0 md:divide-x divide-stone-100">

          <div class="flex flex-col justify-center px-4">

            <div class="text-stone-500 text-xs uppercase mb-1">英文切换点击 EN Switch Clicks</div>

            <div class="text-3xl font-bold text-stone-900">432</div>

            <div class="text-xs text-stone-400 mt-1">按钮交互总量 Total interactions</div>

          </div>

          <div class="flex flex-col justify-center px-4">

            <div class="text-stone-500 text-xs uppercase mb-1">渗透率 Penetration Rate</div>

            <div class="text-3xl font-bold text-amber-600">34.6%</div>

            <div class="text-xs text-stone-400 mt-1">点击占比 Clicks / Total Interactions</div>

          </div>

          <div class="flex flex-col justify-center px-4">

            <div class="text-stone-500 text-xs uppercase mb-1">有效时长比 (英 vs 中) Active Time Ratio</div>

            <div class="flex items-end gap-2">

              <div class="text-3xl font-bold text-stone-900">1 : 4.2</div>

            </div>

            <div class="w-full h-1.5 bg-stone-100 rounded-full mt-3 overflow-hidden flex">

              <div class="bg-stone-800 h-full w-[19%]"></div>

              <div class="bg-stone-300 h-full w-[81%]"></div>

            </div>

            <div class="flex justify-between text-[10px] text-stone-400 mt-1">

              <span>英文 EN (19%)</span>

              <span>中文 CN (81%)</span>

            </div>

          </div>

        </div>

      </div>

    </div>


    <!-- Row 3: Trend Chart -->

    <div class="flex items-center gap-2 mb-3 mt-6">

      <div class="w-1 h-4 bg-amber-600 rounded-full"></div>

      <h2 class="text-lg font-bold text-stone-800">流量趋势 Trends</h2>

    </div>


    <div class="bg-white border border-stone-200 rounded-lg p-6 shadow-sm">

      <div class="flex justify-between items-center mb-6">

        <div class="flex items-center gap-2">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">访问量 (中 vs 英) Visits (CN vs EN)</h3>

        </div>

        <div class="flex bg-stone-100 p-1 rounded-md">

          <button id="tab7d"
            class="px-3 py-1 text-xs font-medium rounded bg-white shadow text-stone-900 transition-all">

            过去7天 Last 7 Days

          </button>

          <button id="tab30d"
            class="px-3 py-1 text-xs font-medium rounded text-stone-500 hover:text-stone-700 transition-all">

            过去30天 Last 30 Days

          </button>

        </div>

      </div>


      <div class="h-[300px] w-full relative">

        <canvas id="trendChart"></canvas>

      </div>

    </div>


    <!-- Row 4: Content Table -->

    <div class="flex items-center gap-2 mb-3 mt-6">

      <div class="w-1 h-4 bg-amber-600 rounded-full"></div>

      <h2 class="text-lg font-bold text-stone-800">词条分析 Content Breakdown</h2>

    </div>


    <div class="bg-white border border-stone-200 rounded-lg shadow-sm overflow-hidden flex flex-col">

      <div class="p-4 border-b border-stone-200 flex justify-between items-center bg-stone-50/50">

        <div class="flex gap-4 items-center">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">词条列表 Entries List</h3>


          <!-- Language Toggle -->

          <div class="flex bg-stone-200 p-0.5 rounded text-[10px] font-medium">

            <button id="langCN" class="px-2 py-0.5 rounded transition-all bg-white text-stone-900 shadow-sm">

              中文 CN

            </button>

            <button id="langEN" class="px-2 py-0.5 rounded transition-all text-stone-500 hover:text-stone-700">

              英文 EN

            </button>

          </div>


          <span class="bg-stone-200 text-stone-600 text-[10px] px-2 py-0.5 rounded-full">点击查看详情 Click for details</span>

        </div>

        <div class="flex gap-2 text-stone-400 items-center">

          <i data-lucide="filter" class="w-4 h-4"></i>

          <span class="text-xs">过滤来源 Filter Sources</span>

        </div>

      </div>


      <div class="overflow-x-auto">

        <table class="w-full text-left text-sm">

          <thead class="bg-white text-stone-500 font-medium border-b border-stone-100">

            <tr>

              <th class="px-6 py-4 font-normal">词条信息 Term Info</th>

              <th class="px-6 py-4 font-normal cursor-pointer hover:bg-stone-50 transition-colors group"
                onclick="app.requestSort('days_active')">

                <div class="flex items-center">

                  上站天数 Days Since Launch

                  <span id="sort-days_active" class="ml-1 opacity-20"><i data-lucide="arrow-down-right"
                      class="w-3 h-3"></i></span>

                </div>

              </th>

              <th class="px-6 py-4 font-normal cursor-pointer hover:bg-stone-50 transition-colors group"
                onclick="app.requestSort('visits_yesterday')">

                <div class="flex items-center">

                  昨日访问 Visits (Yest.)

                  <span id="sort-visits_yesterday" class="ml-1 text-amber-600"><i data-lucide="arrow-down-right"
                      class="w-3 h-3"></i></span>

                </div>

              </th>

              <th class="px-6 py-4 font-normal cursor-pointer hover:bg-stone-50 transition-colors group"
                onclick="app.requestSort('total_visits')">

                <div class="flex items-center">

                  总访问 Total Visits

                  <span id="sort-total_visits" class="ml-1 opacity-20"><i data-lucide="arrow-down-right"
                      class="w-3 h-3"></i></span>

                </div>

              </th>

              <th class="px-6 py-4 font-normal cursor-pointer hover:bg-stone-50 transition-colors group"
                onclick="app.requestSort('total_duration')">

                <div class="flex items-center">

                  总时长 Total Duration

                  <span id="sort-total_duration" class="ml-1 opacity-20"><i data-lucide="arrow-down-right"
                      class="w-3 h-3"></i></span>

                </div>

              </th>

              <th class="px-6 py-4 font-normal text-right">操作 Action</th>

            </tr>

          </thead>

          <tbody id="termsTableBody" class="divide-y divide-stone-100">

            <!-- Rows generated by JS -->

          </tbody>

        </table>

      </div>


      <!-- Pagination Controls -->

      <div class="p-4 border-t border-stone-100 bg-white flex justify-end items-center gap-2" id="paginationControls">

        <!-- Generated by JS -->

      </div>

    </div>


    <!-- Row 5: Interaction Stats Grid -->

    <div class="flex items-center gap-2 mb-3 mt-6">

      <div class="w-1 h-4 bg-amber-600 rounded-full"></div>

      <h2 class="text-lg font-bold text-stone-800">交互行为 Interactions & UX</h2>

    </div>


    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">

      <!-- Search/List -->

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300 border-t-4 border-t-stone-800">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">搜索/列表 Search/List</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-stone-100 text-stone-600 border-stone-200">

            <i data-lucide="clock" class="w-2.5 h-2.5 mr-1"></i> 昨日 Yesterday

          </span>

        </div>

        <div class="flex justify-between items-center py-2 border-b border-stone-100">

          <span class="text-stone-500 text-sm">总使用次数 Total Usage</span>

          <div class="text-right">

            <div class="text-stone-800 font-medium">892</div>

          </div>

        </div>

        <div class="flex justify-between items-center py-2 border-b border-stone-100 last:border-0">

          <span class="text-stone-500 text-sm">使用率 Usage Rate</span>

          <div class="text-right">

            <div class="text-stone-800 font-medium">71.4%</div>

            <div class="text-xs text-stone-400">% 总用户占比 % of UV</div>

          </div>

        </div>

        <div class="mt-3 flex gap-2 text-stone-400">

          <i data-lucide="search" class="w-4 h-4"></i>

          <i data-lucide="layout-list" class="w-4 h-4"></i>

        </div>

      </div>


      <!-- Timeline -->

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300 border-t-4 border-t-stone-400">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">时间轴 Timeline</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-stone-100 text-stone-600 border-stone-200">

            <i data-lucide="clock" class="w-2.5 h-2.5 mr-1"></i> 昨日 Yesterday

          </span>

        </div>

        <div class="flex justify-between items-center py-2 border-b border-stone-100">

          <span class="text-stone-500 text-sm">总使用次数 Total Usage</span>

          <div class="text-right">

            <div class="text-stone-800 font-medium">156</div>

          </div>

        </div>

        <div class="flex justify-between items-center py-2 border-b border-stone-100 last:border-0">

          <span class="text-stone-500 text-sm">使用率 Usage Rate</span>

          <div class="text-right">

            <div class="text-stone-800 font-medium">12.5%</div>

            <div class="text-xs text-stone-400">% 总用户占比 % of UV</div>

          </div>

        </div>

        <div class="mt-3 flex gap-2 text-stone-400">

          <i data-lucide="clock" class="w-4 h-4"></i>

        </div>

      </div>


      <!-- Path Analysis -->

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300 border-t-4 border-t-amber-600">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">路径分析 Path Analysis</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-stone-100 text-stone-600 border-stone-200">

            <i data-lucide="clock" class="w-2.5 h-2.5 mr-1"></i> 昨日 Yesterday

          </span>

        </div>

        <div class="pt-2">

          <div class="text-xs text-stone-500 mb-1">返回地图 Return to Map</div>

          <div class="w-full bg-stone-100 h-2 mb-4 rounded-full">

            <div class="bg-stone-600 h-2 rounded-full" style="width: 64%"></div>

          </div>


          <div class="text-xs text-stone-500 mb-1">点击连线 Link to Next Term</div>

          <div class="w-full bg-stone-100 h-2 mb-2 rounded-full">

            <div class="bg-amber-500 h-2 rounded-full" style="width: 36%"></div>

          </div>

          <div class="flex justify-between text-xs font-bold mt-2">

            <span class="text-stone-600">64% 地图 Map</span>

            <span class="text-amber-600">36% 连线 Link</span>

          </div>

        </div>

      </div>


      <!-- Utility -->

      <div
        class="bg-white border border-stone-200 rounded-lg p-5 shadow-sm hover:shadow-md transition-shadow duration-300 border-t-4 border-t-stone-200">

        <div class="flex justify-between items-start mb-4">

          <h3 class="text-stone-500 text-sm font-bold uppercase tracking-wider">辅助功能 Utility</h3>

          <span
            class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border bg-stone-100 text-stone-600 border-stone-200">

            <i data-lucide="clock" class="w-2.5 h-2.5 mr-1"></i> 昨日 Yesterday

          </span>

        </div>

        <div class="space-y-3">

          <div class="flex justify-between items-center">

            <div class="flex items-center gap-2 text-stone-600 text-sm">

              <i data-lucide="shuffle" class="w-3.5 h-3.5"></i> 随机 Shuffle

            </div>

            <div class="font-bold text-stone-800">14.2%</div>

          </div>

          <div class="flex justify-between items-center">

            <div class="flex items-center gap-2 text-stone-600 text-sm">

              <i data-lucide="info" class="w-3.5 h-3.5"></i> 关于 About

            </div>

            <div class="font-bold text-stone-800">5.8%</div>

          </div>

        </div>

      </div>

    </div>


    <div class="h-10"></div>

  </div>


  <!-- Term Modal (Hidden by default) -->

  <div id="termModal"
    class="hidden fixed inset-0 bg-stone-900/40 backdrop-blur-sm flex items-center justify-center z-50 p-4 transition-opacity duration-200">

    <div
      class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto flex flex-col animate-in fade-in zoom-in-95 duration-200">

      <!-- Header -->

      <div class="p-6 border-b border-stone-200 flex justify-between items-start bg-stone-50">

        <div>

          <div class="text-xs font-bold text-amber-600 uppercase tracking-widest mb-1">词条分析 Entry Analytics</div>

          <h2 id="modalTitleCN" class="text-2xl font-bold text-stone-900">理性无知</h2>

          <p id="modalTitleEN" class="text-lg text-stone-500 italic">Rational Ignorance</p>

        </div>

        <button onclick="app.closeModal()" class="p-2 hover:bg-stone-200 rounded-full transition-colors text-stone-500">

          <i data-lucide="x" class="w-6 h-6"></i>

        </button>

      </div>


      <!-- Body -->

      <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- Left: Engagement -->

        <div class="space-y-6">

          <h3 class="text-sm font-bold text-stone-800 uppercase border-b border-stone-200 pb-2">深度交互 Engagement Depth
          </h3>

          <div class="space-y-4">

            <div>

              <div class="flex justify-between text-sm mb-1">

                <span class="text-stone-600">释义完读 Definition Completion</span>

                <span class="font-bold text-stone-900">68%</span>

              </div>

              <div class="w-full bg-stone-100 rounded-full h-2">

                <div class="bg-stone-800 h-2 rounded-full" style="width: 68%"></div>

              </div>

            </div>

            <div>

              <div class="flex justify-between text-sm mb-1">

                <span class="text-stone-600">笔记点击率 Note CTR</span>

                <span class="font-bold text-stone-900">24%</span>

              </div>

              <div class="w-full bg-stone-100 rounded-full h-2">

                <div class="bg-amber-500 h-2 rounded-full" style="width: 24%"></div>

              </div>

            </div>

            <div>

              <div class="flex justify-between text-sm mb-1">

                <span class="text-stone-600">笔记完读 Note Completion</span>

                <span class="font-bold text-stone-900">45%</span>

              </div>

              <div class="w-full bg-stone-100 rounded-full h-2">

                <div class="bg-amber-300 h-2 rounded-full" style="width: 45%"></div>

              </div>

            </div>

          </div>

        </div>


        <!-- Right: Charts -->

        <div class="space-y-8">

          <!-- Source Pie -->

          <div>

            <h3 class="text-sm font-bold text-stone-800 uppercase border-b border-stone-200 pb-2 mb-4">流量来源 Traffic
              Source</h3>

            <div class="h-48 relative">

              <canvas id="sourceChart"></canvas>

            </div>

          </div>

          <!-- Action Pie -->

          <div>

            <h3 class="text-sm font-bold text-stone-800 uppercase border-b border-stone-200 pb-2 mb-4">后续行为 Next Action
            </h3>

            <div class="h-48 relative">

              <canvas id="actionChart"></canvas>

            </div>

          </div>

        </div>

      </div>

    </div>

  </div>


  <!-- Logic -->

  <script>
    // --- DATA GENERATION ---

    const generateTerms = () => {

      const baseTerms = [

        {
          name_cn: '理性无知',
          name_en: 'Rational Ignorance',
          days_active: 45,
          visits_yesterday_cn: 100,
          visits_yesterday_en: 24,
          visits_growth: 0.12,
          total_visits_cn: 4000,
          total_visits_en: 1430,
          total_duration: '120h'
        },

        {
          name_cn: '可供性',
          name_en: 'Affordance',
          days_active: 120,
          visits_yesterday_cn: 70,
          visits_yesterday_en: 19,
          visits_growth: -0.05,
          total_visits_cn: 9000,
          total_visits_en: 3400,
          total_duration: '340h'
        },

        {
          name_cn: '主体间性',
          name_en: 'Subjectivity',
          days_active: 1,
          visits_yesterday_cn: 300,
          visits_yesterday_en: 40,
          visits_growth: 1.5,
          total_visits_cn: 300,
          total_visits_en: 40,
          total_duration: '18h'
        },

        {
          name_cn: '非场所',
          name_en: 'Non-place',
          days_active: 200,
          visits_yesterday_cn: 45,
          visits_yesterday_en: 20,
          visits_growth: 0.02,
          total_visits_cn: 10000,
          total_visits_en: 5600,
          total_duration: '400h'
        },

        {
          name_cn: '机构',
          name_en: 'Institution',
          days_active: 30,
          visits_yesterday_cn: 80,
          visits_yesterday_en: 30,
          visits_growth: 0.08,
          total_visits_cn: 1500,
          total_visits_en: 600,
          total_duration: '65h'
        },

        {
          name_cn: '加速主义',
          name_en: 'Accelerationism',
          days_active: 60,
          visits_yesterday_cn: 50,
          visits_yesterday_en: 28,
          visits_growth: -0.1,
          total_visits_cn: 3000,
          total_visits_en: 1300,
          total_duration: '98h'
        },

        {
          name_cn: '全景敞视',
          name_en: 'Panopticon',
          days_active: 365,
          visits_yesterday_cn: 30,
          visits_yesterday_en: 15,
          visits_growth: 0.0,
          total_visits_cn: 18000,
          total_visits_en: 7000,
          total_duration: '600h'
        },

        {
          name_cn: '熵增',
          name_en: 'Entropy',
          days_active: 14,
          visits_yesterday_cn: 120,
          visits_yesterday_en: 36,
          visits_growth: 0.25,
          total_visits_cn: 1400,
          total_visits_en: 400,
          total_duration: '45h'
        },

        {
          name_cn: '拟像',
          name_en: 'Simulacra',
          days_active: 8,
          visits_yesterday_cn: 90,
          visits_yesterday_en: 12,
          visits_growth: 0.4,
          total_visits_cn: 600,
          total_visits_en: 100,
          total_duration: '22h'
        },

        {
          name_cn: '根茎',
          name_en: 'Rhizome',
          days_active: 90,
          visits_yesterday_cn: 55,
          visits_yesterday_en: 22,
          visits_growth: 0.05,
          total_visits_cn: 5500,
          total_visits_en: 2100,
          total_duration: '210h'
        },

      ];


      const extraTerms = Array.from({
        length: 42
      }, (_, i) => ({

        name_cn: `概念 ${i + 11}`,

        name_en: `Concept ${i + 11}`,

        days_active: Math.floor(Math.random() * 400),

        visits_yesterday_cn: Math.floor(Math.random() * 200),

        visits_yesterday_en: Math.floor(Math.random() * 50),

        visits_growth: (Math.random() * 0.4) - 0.2,

        total_visits_cn: Math.floor(Math.random() * 10000),

        total_visits_en: Math.floor(Math.random() * 3000),

        total_duration: `${Math.floor(Math.random() * 500)}h`

      }));


      const allTerms = [...baseTerms, ...extraTerms];

      return allTerms.map((term, index) => {

        const idNum = (index + 1).toString().padStart(4, '0');

        return {

          ...term,

          id_cn: `CN${idNum}`,

          id_en: `EN${idNum}`

        };

      });

    };


    const termsData = generateTerms();


    const trendData7Days = {

      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],

      cn: [400, 300, 550, 450, 600, 800, 750],

      en: [120, 130, 180, 140, 200, 250, 240]

    };


    const trendData30Days = {

      labels: Array.from({
        length: 15
      }, (_, i) => `Day ${i + 1}`),

      cn: Array.from({
        length: 15
      }, () => Math.floor(Math.random() * 500) + 300),

      en: Array.from({
        length: 15
      }, () => Math.floor(Math.random() * 200) + 50)

    };


    const sourceData = {

      labels: ['地图 Map', '搜索 Search', '连线 Line', '随机 Shuffle', '其他 Other'],

      data: [40, 25, 20, 10, 5],

      colors: ['#4b5563', '#9ca3af', '#d1d5db', '#e5e7eb', '#f3f4f6']

    };


    const actionData = {

      labels: ['返回地图 Return Map', '点击连线 Click Line', '离开 Leave', '其他 Other'],

      data: [35, 45, 15, 5],

      colors: ['#4b5563', '#d97706', '#ef4444', '#e5e7eb']

    };


    // --- APP STATE & LOGIC ---

    const app = {

      state: {

        activeTab: '7d', // '7d' or '30d'

        contentLang: 'cn', // 'cn' or 'en'

        sortKey: 'visits_yesterday',

        sortDirection: 'desc', // 'asc' or 'desc'

        currentPage: 1,

        itemsPerPage: 8,

        exportMenuOpen: false

      },

      charts: {

        trend: null,

        source: null,

        action: null

      },


      init() {

        this.initIcons();

        this.initEventListeners();

        this.renderTrendChart();

        this.renderTable();

      },


      initIcons() {

        lucide.createIcons();

      },


      initEventListeners() {

        // Export Toggle

        document.getElementById('exportBtn').addEventListener('click', (e) => {

          e.stopPropagation();

          this.state.exportMenuOpen = !this.state.exportMenuOpen;

          document.getElementById('exportMenu').classList.toggle('hidden', !this.state.exportMenuOpen);

        });

        document.addEventListener('click', () => {

          this.state.exportMenuOpen = false;

          document.getElementById('exportMenu').classList.add('hidden');

        });


        // Trend Tabs

        document.getElementById('tab7d').addEventListener('click', () => this.switchTrendTab('7d'));

        document.getElementById('tab30d').addEventListener('click', () => this.switchTrendTab('30d'));


        // Language Toggle

        document.getElementById('langCN').addEventListener('click', () => this.switchLang('cn'));

        document.getElementById('langEN').addEventListener('click', () => this.switchLang('en'));

      },


      switchTrendTab(tab) {

        this.state.activeTab = tab;

        // Update Buttons

        const btn7 = document.getElementById('tab7d');

        const btn30 = document.getElementById('tab30d');

        const activeClasses = ['bg-white', 'shadow', 'text-stone-900'];

        const inactiveClasses = ['text-stone-500', 'hover:text-stone-700'];


        if (tab === '7d') {

          btn7.classList.add(...activeClasses);

          btn7.classList.remove(...inactiveClasses);

          btn30.classList.remove(...activeClasses);

          btn30.classList.add(...inactiveClasses);

        } else {

          btn30.classList.add(...activeClasses);

          btn30.classList.remove(...inactiveClasses);

          btn7.classList.remove(...activeClasses);

          btn7.classList.add(...inactiveClasses);

        }

        this.renderTrendChart();

      },


      switchLang(lang) {

        this.state.contentLang = lang;

        const btnCN = document.getElementById('langCN');

        const btnEN = document.getElementById('langEN');

        const activeClass = ['bg-white', 'text-stone-900', 'shadow-sm'];

        const inactiveClass = ['text-stone-500', 'hover:text-stone-700'];


        // Clear all

        btnCN.classList.remove(...activeClass, ...inactiveClass);

        btnEN.classList.remove(...activeClass, ...inactiveClass);


        if (lang === 'cn') {

          btnCN.classList.add(...activeClass);

          btnEN.classList.add(...inactiveClass);

        } else {

          btnEN.classList.add(...activeClass);

          btnCN.classList.add(...inactiveClass);

        }

        this.renderTable();

      },


      requestSort(key) {

        if (this.state.sortKey === key) {

          this.state.sortDirection = this.state.sortDirection === 'asc'
          ? 'desc' : 'asc';

        } else {

          this.state.sortKey = key;

          this.state.sortDirection = 'asc';

        }

        this.updateSortIcons();

        this.renderTable();

      },


      updateSortIcons() {

        // Reset all icons to default faint down arrow

        ['days_active', 'visits_yesterday', 'total_visits', 'total_duration'].forEach(k => {

          const el = document.getElementById(`sort-${k}`);

          el.className = 'ml-1 opacity-20';

          el.innerHTML = '<i data-lucide="arrow-down-right" class="w-3 h-3"></i>';

        });


        // Update active icon

        const activeEl = document.getElementById(`sort-${this.state.sortKey}`);

        activeEl.className = 'ml-1 text-amber-600';

        const iconName = this.state.sortDirection === 'asc'
        ? 'arrow-up-right' : 'arrow-down-right';

        activeEl.innerHTML = `<i data-lucide="${iconName}" class="w-3 h-3"></i>`;

        lucide.createIcons();

      },


      getSortedData() {

        const {
          sortKey,
          sortDirection,
          contentLang
        } = this.state;

        let data = [...termsData];


        // Helper to get value based on lang

        const getValue = (item, key) => {

          if (key === 'visits_yesterday') return contentLang === 'cn'
          ? item.visits_yesterday_cn : item.visits_yesterday_en;

          if (key === 'total_visits') return contentLang === 'cn'
          ? item.total_visits_cn : item.total_visits_en;

          return item[key];

        };


        data.sort((a, b) => {

          const valA = getValue(a, sortKey);

          const valB = getValue(b, sortKey);


          // Simple numeric/string comparison

          let comparison = 0;

          if (typeof valA === 'string') {

            comparison = parseInt(valA) > parseInt(valB) ? 1 : -1;

          } else {

            comparison = valA > valB ? 1 : -1;

          }


          return sortDirection === 'asc'
          ? comparison : -comparison;

        });

        return data;

      },


      setPage(page) {

        this.state.currentPage = page;

        this.renderTable();

      },


      renderTable() {

        const sorted = this.getSortedData();

        const start = (this.state.currentPage - 1) * this.state.itemsPerPage;

        const end = start + this.state.itemsPerPage;

        const pageData = sorted.slice(start, end);

        const tbody = document.getElementById('termsTableBody');


        tbody.innerHTML = pageData.map(term => {

          const isCN = this.state.contentLang === 'cn';

          const mainName = isCN ? term.name_cn : term.name_en;

          const subName = isCN ? term.name_en : term.name_cn;

          const id = isCN ? term.id_cn : term.id_en;

          const yesterday = isCN ? term.visits_yesterday_cn : term.visits_yesterday_en;

          const total = isCN ? term.total_visits_cn : term.total_visits_en;


          const growthBadge = term.visits_growth !== 0 ? `

                        <span class="text-[10px] px-1.5 py-0.5 rounded ${term.visits_growth > 0 ? 'bg-green-100 text-green-700' : 'bg-red-50 text-red-600'}">

                            ${term.visits_growth > 0 ? '+' : ''}${(term.visits_growth * 100).toFixed(0)}%

                        </span>

                    ` : '';


          return `

                        <tr class="hover:bg-amber-50/30 transition-colors cursor-pointer group" onclick='app.openModal(${JSON.stringify(term).replace(/'/g, "&#39;")})'>

                            <td class="px-6 py-4">

                                <div class="font-bold text-stone-900">${mainName}</div>

                                <div class="text-xs text-stone-500 italic">${subName}</div>

                                <div class="text-[10px] text-stone-300 mt-1 font-mono">ID: ${id}</div>

                            </td>

                            <td class="px-6 py-4 text-stone-600">

                                ${term.days_active} <span class="text-xs text-stone-400">天 days</span>

                            </td>

                            <td class="px-6 py-4">

                                <div class="flex items-center gap-2">

                                    <span class="text-stone-900 font-medium">${yesterday}</span>

                                    ${growthBadge}

                                </div>

                            </td>

                            <td class="px-6 py-4 text-stone-600 font-medium">

                                ${total.toLocaleString()}

                            </td>

                            <td class="px-6 py-4 text-stone-600">

                                ${term.total_duration}

                            </td>

                            <td class="px-6 py-4 text-right">

                                <button class="text-stone-300 group-hover:text-amber-600 transition-colors">

                                    <i data-lucide="layout-list" class="w-[18px] h-[18px]"></i>

                                </button>

                            </td>

                        </tr>

                    `;

        }).join('');


        this.renderPagination(sorted.length);

        lucide.createIcons();

      },


      renderPagination(totalItems) {

        const totalPages = Math.ceil(totalItems / this.state.itemsPerPage);

        const container = document.getElementById('paginationControls');

        const curr = this.state.currentPage;


        // Prev Button

        let html = `

                    <button onclick="app.setPage(${Math.max(1, curr - 1)})" ${curr === 1 ? 'disabled' : ''} class="p-1 rounded hover:bg-stone-100 text-stone-500 disabled:opacity-30 disabled:hover:bg-white">

                        <i data-lucide="chevron-left" class="w-4 h-4"></i>

                    </button>

                `;


        // Numbers (Simplified 1-5 logic)

        const maxBtns = 5;

        let startPage = 1;

        if (totalPages > maxBtns && curr > 3) {

          startPage = curr - 2;

          if (startPage + maxBtns > totalPages) startPage = totalPages - maxBtns + 1;

        }

        const endPage = Math.min(totalPages, startPage + maxBtns - 1);


        for (let i = startPage; i <= endPage; i++) {

          html += `

                        <button onclick="app.setPage(${i})" class="w-6 h-6 text-xs rounded font-medium transition-colors ${i === curr ? 'bg-stone-900 text-white' : 'text-stone-500 hover:bg-stone-100'}">

                            ${i}

                        </button>

                     `;

        }


        // Next Button

        html += `

                    <button onclick="app.setPage(${Math.min(totalPages, curr + 1)})" ${curr === totalPages ? 'disabled' : ''} class="p-1 rounded hover:bg-stone-100 text-stone-500 disabled:opacity-30 disabled:hover:bg-white">

                        <i data-lucide="chevron-right" class="w-4 h-4"></i>

                    </button>

                `;


        container.innerHTML = html;

        lucide.createIcons();

      },


      renderTrendChart() {

        const ctx = document.getElementById('trendChart').getContext('2d');

        const data = this.state.activeTab === '7d'
        ? trendData7Days : trendData30Days;


        if (this.charts.trend) this.charts.trend.destroy();


        this.charts.trend = new Chart(ctx, {

          type: 'line',

          data: {

            labels: data.labels,

            datasets: [

              {

                label: '中文版 Chinese Ver.',

                data: data.cn,

                borderColor: '#44403c', // Stone 700

                backgroundColor: '#44403c',

                borderWidth: 2,

                tension: 0.4, // Monotone curve

                pointRadius: 3,

                pointHoverRadius: 6

              },

              {

                label: '英文版 English Ver.',

                data: data.en,

                borderColor: '#d97706', // Amber 600

                backgroundColor: '#d97706',

                borderWidth: 2,

                tension: 0.4,

                pointRadius: 3,

                pointHoverRadius: 6

              }

            ]

          },

          options: {

            responsive: true,

            maintainAspectRatio: false,

            plugins: {

              legend: {

                position: 'bottom',

                labels: {
                  usePointStyle: true,
                  boxWidth: 6,
                  font: {
                    family: 'ui-sans-serif'
                  }
                }

              },

              tooltip: {

                backgroundColor: '#fff',

                titleColor: '#1c1917',

                bodyColor: '#44403c',

                borderColor: '#e7e5e4',

                borderWidth: 1,

                padding: 10,

                displayColors: true,

                boxPadding: 4

              }

            },

            scales: {

              x: {

                grid: {
                  display: false,
                  drawBorder: false
                },

                ticks: {
                  color: '#78716c',
                  font: {
                    size: 12
                  }
                }

              },

              y: {

                grid: {
                  color: '#e5e7eb',
                  drawBorder: false
                },

                ticks: {
                  color: '#78716c',
                  font: {
                    size: 12
                  }
                },

                border: {
                  display: false
                }

              }

            },

            interaction: {

              mode: 'index',

              intersect: false,

            },

          }

        });

      },


      renderPieChart(id, labels, data, colors) {

        const ctx = document.getElementById(id).getContext('2d');

        if (this.charts[id]) this.charts[id].destroy();


        this.charts[id] = new Chart(ctx, {

          type: 'pie',

          data: {

            labels: labels,

            datasets: [{

              data: data,

              backgroundColor: colors,

              borderWidth: 0

            }]

          },

          options: {

            responsive: true,

            maintainAspectRatio: false,

            layout: {
              padding: {
                left: 20,
                right: 20
              }
            },

            plugins: {

              legend: {

                position: 'right',

                labels: {
                  boxWidth: 10,
                  font: {
                    size: 10
                  },
                  color: '#4b5563'
                }

              },

              tooltip: {

                callbacks: {

                  label: function (context) {

                    return context.label + ': ' + context.parsed + '%';

                  }

                }

              },

              datalabels: { // Note: Chart.js needs a plugin for on-chart labels usually, simulating basic one here via tooltips

                display: true

              }

            }

          },

          plugins: [{

            id: 'percentLabels',

            afterDatasetsDraw(chart, args, pluginOptions) {

              const {
                ctx,
                data
              } = chart;

              chart.data.datasets.forEach((dataset, i) => {

                const meta = chart.getDatasetMeta(i);

                meta.data.forEach((element, index) => {

                  // Draw Percentage Text

                  const model = element.tooltipPosition();

                  const percent = dataset.data[index] + "%";


                  // Calculate position

                  const midAngle = element.startAngle + (element.endAngle - element.startAngle) / 2;

                  const x = Math.cos(midAngle) * (element.outerRadius * 0.7) + element.x;

                  const y = Math.sin(midAngle) * (element.outerRadius * 0.7) + element.y;


                  ctx.save();

                  ctx.fillStyle = '#fff';

                  ctx.font = 'bold 10px sans-serif';

                  ctx.textAlign = 'center';

                  ctx.textBaseline = 'middle';

                  ctx.fillText(percent, x, y);

                  ctx.restore();

                });

              });

            }

          }]

        });

      },


      openModal(term) {

        document.getElementById('modalTitleCN').innerText = term.name_cn;

        document.getElementById('modalTitleEN').innerText = term.name_en;

        document.getElementById('termModal').classList.remove('hidden');


        // Render Charts inside modal

        setTimeout(() => {

          this.renderPieChart('sourceChart', sourceData.labels, sourceData.data, sourceData.colors);

          this.renderPieChart('actionChart', actionData.labels, actionData.data, actionData.colors);

        }, 100);

      },


      closeModal() {

        document.getElementById('termModal').classList.add('hidden');

      }

    };


    // Initialize App

    document.addEventListener('DOMContentLoaded', () => {

      app.init();

    });
  </script>

</body>

</html>
